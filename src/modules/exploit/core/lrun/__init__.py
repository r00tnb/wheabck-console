r'''Run a command on local.
'''

from api.exploit import Exploit, Cmdline
import argparse
import os

class exploit(Exploit):
    def __init__(self):
        self.parse = argparse.ArgumentParser(prog='lrun', description='Run a command on local.')
        self.parse.add_argument('cmd', help="A command name")
        self.help = __doc__ + self.parse.format_help()

    def support(self, session)-> bool:
        '''判断当前命令是否支持指定的session， 一般来说session即为运行改命令时的session
        '''
        self.session = session
        return True

    def run(self, args: Cmdline)-> int:
        options = [Cmdline(args.options).cmdline]
        args = self.parse.parse_args(options)
        if args.cmd:
            os.system(args.cmd)
            return self.SUCCESS

        return self.STOP