r'''Show current directory.
'''

from api.exploit import WebshellExploit, Cmdline
from api.webshell import WebshellSession, Webshell
from api import logger, config, utils, colour
import argparse
import base64
import tempfile
import os
import json

class exploit(WebshellExploit):

    def __init__(self):
        super().__init__()
        self.parse = argparse.ArgumentParser(prog="pwd", description="Show current directory.")
        self.help = __doc__ + self.parse.format_help()

    def support(self, session:WebshellSession)-> bool:
        '''判断当前命令是否支持指定的session， 一般来说session即为运行该命令时的session
        '''
        self.session = session
        return isinstance(self.session, WebshellSession)

    def run(self, args:Cmdline)-> int:
        args = self.parse.parse_args(args.options)
        print(self.session.pwd)
        return self.SUCCESS