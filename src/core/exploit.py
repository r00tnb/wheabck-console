

from src.core.base import Command, Cmdline, WebshellBase, call_path
from src.core.session import WebshellSession, Session
from src.core.payload import Payload, PHPPayload
import os

class Exploit(Command):

    def __init__(self):
        super().__init__()
        self.session = None
        self.name = self.__class__.__module__ # 该字段一般会在加载时覆盖为模块名

    # def docomplete(self, text: str)-> dict:# 如果提供了该函数，则会使用该函数参与命令补全
    #     '''
    #     Return Format:
    #         {'pre':'', 'matchs':[]}
    #     '''
    #     pass

    def support(self, session: Session)-> bool:
        '''判断当前命令是否支持指定的session， 一般来说session即为运行改命令时的session
        '''
        self.session = session
        return True

    def hook_loaded(self):
        '''当所属session加载完毕时调用
        '''
        pass

    def hook_destroy(self):
        '''当所属session被销毁时调用
        '''
        pass
